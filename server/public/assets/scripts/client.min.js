var app=angular.module("clientApp",["ngRoute"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/home_page.html",controller:"HomeController"}).when("/about",{templateUrl:"views/about.html",controller:"AboutController"}).when("/sign_in",{templateUrl:"views/sign_in.html",controller:"SignInController"}).when("/register",{templateUrl:"views/register.html",controller:"RegisterController"}).when("/guest",{templateUrl:"views/guest.html",controller:"GuestController"}).when("/success",{templateUrl:"views/user_welcome.html",controller:"UserController"}).when("/fail",{templateUrl:"views/fail.html",controller:"FailController"}).when("/register_success",{templateUrl:"views/register_success.html",controller:"RegisterSuccessController"}).when("/edit_profile",{templateUrl:"views/edit_profile.html",controller:"EditProfileController"}).when("/profile_update_success",{templateUrl:"views/profile_update_success.html",controller:"ProfileUpdateSuccessController"}).when("/view_data",{templateUrl:"views/view_data.html",controller:"ViewDataController"}).when("/new_entry",{templateUrl:"views/new_entry.html",controller:"NewEntryController"}).when("/entry_success",{templateUrl:"views/entry_success.html",controller:"EntrySuccessController"}).when("/update_success",{templateUrl:"views/update_success.html",controller:"UpdateSucessController"}).when("/edit_entry",{templateUrl:"views/edit_entry.html",controller:"EditEntryController"}).when("/view_entry",{templateUrl:"views/view_entry.html",controller:"ViewEntryController"}).when("/log_out",{templateUrl:"views/log_out.html",controller:"LogOutController"}).otherwise({redirectTo:"/"}),b.html5Mode(!0)}]),app.controller("MainController",["$scope","userData",function(a,b){a.notSignedIn=!0,a.signedIn=!1,changeNavLinks=function(){""!==b.currentUser.username?(a.notSignedIn=!1,a.signedIn=!0):(a.notSignedIn=!0,a.signedIn=!1)}}]),app.controller("HomeController",["$scope","userData",function(a,b){a.about=!1,a.toggleAbout=function(){a.about=a.about===!0?!1:!0}}]),app.controller("AboutController",["$scope",function(a){}]),app.controller("SignInController",["$scope","$http","$location","userData",function(a,b,c,d){a.data={},a.submitData=function(){b.post("/",a.data).then(function(b){"success"==b.data&&(d.setUser(a.data.username),d.setUserID(a.data.username)),c.path(b.data)})}}]),app.controller("RegisterController",["$scope","$http","$location",function(a,b,c){a.data={},a.registerData=function(){b({url:"/api/registerUser",method:"POST",params:{username:a.data.username,password:a.data.password,first_name:a.data.first_name,last_name:a.data.last_name,email:a.data.email}}).then(function(a){c.path(a.data)})}}]),app.controller("RegisterSuccessController",["$scope","$http",function(a,b){}]),app.controller("GuestController",["$scope","$http","$location","userData","currentEntry",function(a,b,c,d,e){a.thisUser="";var f="";a.sortType=!1,a.keyword=!1,a.responseLength=0,a.complexResponse=!1,a.categorySelect="All",a.categories=["All","Birds","Mammals","Herps","Invertebrates","Plants","Other"],a.view="View More",a.startDate="",a.endDate="",a.nameSearch="",a.locationSearch="",a.globalSearch=!0,a.keywordParam="",a.entries=[],a.sortTypeTog=function(){a.sortType=a.sortType===!0?!1:!0,a.keyword=!1,a.entries=[]},a.keywordTog=function(){a.keyword=a.keyword===!0?!1:!0,a.sortType=!1,a.entries=[]},a.getComplexList=function(){a.entrie=[];var c=a.categorySelect,d=a.startDate,e=a.endDate,g="%"+a.nameSearch+"%",h="%"+a.locationSearch+"%";"All"==a.categorySelect&&(c=null),""===a.startDate&&(d=0),""===a.endDate&&(e=9999),b({url:"/api/getComplexList",method:"GET",params:{user_id:f,category:c,start_date:d,end_date:e,name_search:g,location_search:h,global_search:a.globalSearch}}).then(function(b){a.entries=b.data,a.responseLength=b.data.length,a.complexResponse=!0})},a.globalView=function(a){e.setEntry(a),c.path("/view_entry")},a.keywordSearch=function(){var c="%"+a.keywordParam+"%";b({url:"/api/getKeyword",method:"GET",params:{user_id:f,keyword:c,global_search:a.globalSearch}}).then(function(b){a.entries=b.data,a.responseLength=b.data.length,a.complexResponse=!0,console.log(b.data)})}}]),app.controller("UserController",["$scope","userData",function(a,b){a.thisUser=b.currentUser.username,a.welcome="Welcome, "+a.thisUser+"!",a.getID=function(){console.log("User id: ",b.currentUser.id)}}]),app.controller("EditProfileController",["$scope","userData","$http","$location",function(a,b,c,d){a.thisUser=b.currentUser,a.update=!1,a.data={},a.showUpdate=function(){a.update=a.update===!0?!1:!0,a.data=b.currentUser},a.cancel=function(){a.update=!1,a.data={},a.thisUser=b.currentUser},a.registerUpdate=function(){c({url:"/api/registerUpdate",method:"POST",params:{id:a.data.id,username:a.data.username,password:a.data.password,first_name:a.data.first_name,last_name:a.data.last_name,email:a.data.email}}).then(function(a){d.path(a.data)})}}]),app.controller("ProfileUpdateSuccessController",["$scope",function(a){}]),app.controller("EntrySuccessController",["$scope","userData",function(a,b){}]),app.controller("UpdateSucessController",["$scope","userData",function(a,b){}]),app.controller("LogOutController",["$scope","$http","userData","$location",function(a,b,c,d){a.warning="Are you sure you want to log out, "+c.currentUser.username+"?",a.logOut=function(){c.clearUser(),b.get("/logout",function(){}).then(function(a){d.path(a.data)})}}]),app.controller("FailController",["$scope",function(a){}]),app.controller("ViewDataController",["$scope","userData","currentEntry","$http","$location",function(a,b,c,d,e){a.thisUser=b.currentUser.username;var f=b.currentUser.id;a.simpleList=!1,a.sortType=!1,a.keyword=!1,a.viewTable=!1,a.responseLength=0,a.complexResponse=!1,a.categorySelect="All",a.categories=["All","Birds","Mammals","Herps","Invertebrates","Plants","Other"],a.view="View More",a.startDate="",a.endDate="",a.nameSearch="",a.locationSearch="",a.globalSearch=!1,a.keywordParam="",a.entries=[],a.simpleListTog=function(){a.simpleList=a.simpleList===!0?!1:!0,a.sortType=!1,a.keyword=!1,a.viewTable=!1,a.entries=[],a.responseLength=0,a.complexResponse=!1},a.sortTypeTog=function(){a.sortType=!0,a.keyword=!1,a.viewTable=!1,a.simpleList=!1,a.entries=[],a.responseLength=0,a.complexResponse=!1},a.keywordTog=function(){a.keyword=a.keyword===!0?!1:!0,a.sortType=!1,a.simpleList=!1,a.viewTable=!1,a.entries=[],a.responseLength=0,a.complexResponse=!1},a.viewTableTog=function(){a.viewTable=a.viewTable===!0?!1:!0,a.sortType=!1,a.keyword=!1,a.simpleList=!1,a.entries=[],a.responseLength=0,a.complexResponse=!1},a.getSimpleList=function(){var b=a.categorySelect;b="All"==a.categorySelect?null:a.categorySelect,d({url:"/api/getSimpleList",method:"GET",params:{user_id:f,category:b}}).then(function(b){for(i=0;i<b.data.length;i++)b.data[i].show=!1,b.data[i].view="View More";a.entries=b.data})},a.getTableData=function(){d({url:"/api/getTableData",method:"GET",params:{user_id:f}}).then(function(b){a.entries=b.data})},a.viewEntry=function(a){a.show=a.show===!0?!1:!0,"View More"==a.view?a.view="View Less":a.view="View More"},a.getComplexList=function(){a.entries=[];var b=a.categorySelect,c=a.startDate,e=a.endDate,g="%"+a.nameSearch+"%",h="%"+a.locationSearch+"%";"All"==a.categorySelect&&(b=null),""===a.startDate&&(c=0),""===a.endDate&&(e=9999),d({url:"/api/getComplexList",method:"GET",params:{user_id:f,category:b,start_date:c,end_date:e,name_search:g,location_search:h,global_search:a.globalSearch}}).then(function(b){a.entries=b.data,a.responseLength=b.data.length,a.complexResponse=!0})},a.globalView=function(a){c.setEntry(a),e.path("/view_entry")},a.keywordSearch=function(){var b="%"+a.keywordParam+"%";d({url:"/api/getKeyword",method:"GET",params:{user_id:f,keyword:b,global_search:a.globalSearch}}).then(function(b){a.entries=b.data,a.responseLength=b.data.length,a.complexResponse=!0,console.log(b.data)})},a.editEntry=function(a){c.setEntry(a),e.path("/edit_entry")}}]),app.controller("ViewEntryController",["$scope","userData","currentEntry","$location",function(a,b,c,d){a.data=c.currentEntry.data,a.weather=[],a.groupMessage="",a.loggedInUser=!1,a.thisUser=b.currentUser.username,makeWeather=function(){a.data.sunny===!0&&a.weather.push("Sunny"),a.data.raining===!0&&a.weather.push("Raining"),a.data.foggy===!0&&a.weather.push("Foggy"),a.data.snowing===!0&&a.weather.push("Snowing"),a.data.windy===!0&&a.weather.push("Windy"),a.data.overcast===!0&&a.weather.push("Overcast"),null!==a.data.other_weather&&a.weather.push(a.data.other_weather)},makeGroupInfo=function(){var b="";a.data.number_in_group>1&&(b=" of "+a.data.number_in_group+" individuals."),"group"==a.data.is_group?a.groupMessage="Spotted in a group"+b:"individual"==a.data.is_group&&(a.groupMessage="Spotted as an individual.")},userLoggedIn=function(){a.data.username==a.thisUser&&(a.loggedInUser=!0)},a.editEntry=function(){c.setEntry(a.data),d.path("/edit_entry")},makeWeather(),makeGroupInfo(),userLoggedIn()}]),app.controller("EditEntryController",["$scope","$http","$location","userData","currentEntry",function(a,b,c,d,e){a.data=e.currentEntry.data,console.log(a.data),a.timeList=["Dawn","Morning","Mid Day","Afternoon","Dusk","Night"],a.categories=["Birds","Mammals","Herps","Invertebrates","Plants","Other"],a.sexList=["Female","Male","Unknown"],a.ageList=["Adult","Juvenile","Neonate"],a.tempList=["0˚<","0˚ - 15˚","16˚ - 32˚","33˚ - 49˚","50˚ - 69˚","70˚ - 89˚",">90˚"];var f,g=d.currentUser.username,h=d.currentUser.id;a.updateEntry=function(){b({url:"/api/updateEntry",method:"POST",params:{user_id:h,username:g,date_updated:f,category:a.data.category,common_name:a.data.common_name,scientific_name:a.data.scientific_name,location_country:a.data.location_country,location_state:a.data.location_state,location_county:a.data.location_county,year_spotted:a.data.year_spotted,month_spotted:a.data.month_spotted,day_spotted:a.data.day_spotted,time_spotted:a.data.time_spotted,group:a.data.group,number_in_group:a.data.number_in_group,individual_sex:a.data.sex,individual_age:a.data.age,individual_description:a.data.individual_description,sunny:a.data.sunny,overcast:a.data.overcast,raining:a.data.raining,snowing:a.data.snowing,foggy:a.data.foggy,windy:a.data.windy,other_weather:a.data.other_weather,temperature:a.data.temperature,additional_notes:a.data.additional_notes,id:a.data.id}}).then(function(a){c.path(a.data)})}}]),app.controller("NewEntryController",["$scope","$http","$location","userData",function(a,b,c,d){a.data={},a.timeList=["Dawn","Morning","Mid Day","Afternoon","Dusk","Night"],a.categories=["Birds","Mammals","Herps","Invertebrates","Plants","Other"],a.sexList=["Female","Male","Unknown"],a.ageList=["Adult","Juvenile","Neonate"],a.tempList=["0˚<","0˚ - 15˚","16˚ - 32˚","33˚ - 49˚","50˚ - 69˚","70˚ - 89˚",">90˚"];var e,f=d.currentUser.username,g=d.currentUser.id;a.submitEntry=function(){b({url:"/api/newEntry",method:"POST",params:{user_id:g,username:f,date_submitted:e,category:a.data.category,common_name:a.data.common_name,scientific_name:a.data.scientific_name,location_country:a.data.location_country,location_state:a.data.location_state,location_county:a.data.location_county,year_spotted:a.data.year_spotted,month_spotted:a.data.month_spotted,day_spotted:a.data.day_spotted,time_spotted:a.data.time_spotted,group:a.data.group,number_in_group:a.data.number_in_group,individual_sex:a.data.sex,individual_age:a.data.age,individual_description:a.data.individual_description,sunny:a.data.sunny,overcast:a.data.overcast,raining:a.data.raining,snowing:a.data.snowing,foggy:a.data.foggy,windy:a.data.windy,other_weather:a.data.other_weather,temperature:a.data.temperature,additional_notes:a.data.additional_notes}}).then(function(a){c.path(a.data)})}}]),app.factory("userData",["$http","$timeout",function(a,b){var c={username:"",id:"",first_name:"",last_name:"",email:"",password:""},d=function(a){c.username=a,changeNavLinks()},e=function(b){var d="/"+b;a.get("/api/getUser"+d).then(function(a){c.id=a.data.user.id,c.first_name=a.data.user.first_name,c.last_name=a.data.user.last_name,c.email=a.data.user.email,c.password=a.data.user.password})},f=function(a){c.username="",changeNavLinks()};return{currentUser:c,setUser:d,setUserID:e,clearUser:f}}]),app.factory("currentEntry",["$http",function(a){var b={data:{}},c=function(a){b.data=a},d=function(){b.data={}};return{currentEntry:b,setEntry:c,clearCurrentEntry:d}}]);